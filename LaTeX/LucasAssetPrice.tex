\documentclass{handout}
\usepackage{handoutSetup}\usepackage{handoutShortcuts}
\begin{CDCPrivate}
\begin{comment} % By CDC, first draft while walking dogs, on the occasion of reading Sargent's lecture notes praising the Lucas model as "beautiful"

Truth is not beauty, nor is beauty truth,
despite Plato and Keats, \textit{pace} Barro and Muth;

When brought to real data, all theories unravel;
like fairytale princes, they just cannot travel
from bastions of mathland, all tidy and clean,
where nobody ever asks ``what {\emph does} it all \textit{mean}?''

The recent debacle in macro and finance
has tempered the ardor, has cooled the romance
so why haven't theorists deserted the field,
at least till their wounds have started to heal?

Because changes in thinking are often quite slow,
even when the real world serves a body blow.

But progress does happen, in fits and in starts,
[something about how we're getting to a much better place, eventually -- maybe ending in smarts]...
\end{comment}
\end{CDCPrivate}

\begin{document}
\handoutHeader

\begin{verbatimwrite}{\jobname.title}
The Lucas Asset Pricing Model
\end{verbatimwrite}

\handoutNameMake

%\Large 
\section{Introduction/Setup}
\cite{lucas:assetpricing} considers an economy populated by infinitely many\footnote{As in \Aggregation.}  identical individual consumers, in which the only assets are a set of identical infinitely-lived trees.  Aggregate output is the fruit that falls from the trees, and cannot be stored (it would rot!); because $\uFunc^{\prime}(\cRat)>0~\forall~\cRat$, the fruit is all eaten:
\begin{equation}\begin{gathered}\begin{aligned}
\cRat_{t}\Pop_{t} & =  \dvdnd_{t}\Kap_{t} \label{eq:CeqY}
\end{aligned}\end{gathered}\end{equation}
where $\cRat_{t}$ is consumption of fruit per person, $\Pop_{t}$ is
the population, $\dvdnd_{t}$ is the exogenous output of fruit that
\textit{d}rops from each tree and $\Kap_{t}$ is the stock of
trees.\opt{MarginNotes}{\marginpar{\tiny Crucial assumption: the stock
    of trees is \textit{exogenous}; you can't consume a little less fruit
    and have more trees next period.}}  (In a given year, each tree
produces exactly the same amount of fruit as every other tree, but
$\dvdnd_{t}$ varies from year to year depending on the weather.)  An
economy like this, in which output arrives without any deliberate
actions on the part of residents, is called an `endowment' economy
(or, sometimes, an `exchange' economy).\footnote{The alternative is a `production' economy, in which factors of production -- labor, capital, maybe land, maybe knowledge -- are combined with each other generate the output.}  \opt{\marginpar{\tiny Market
    for buying and selling trees by individual consumers.}}{}
\opt{\marginpar{\tiny Model requires mental gymnastics: lots of
    identical individual consumers must be satisfied.}}{}

\hypertarget{The-Market-for-Trees}{}
\section{The Market for Trees}

In equilibrium, the price of trees must be such that, each period,
each (identical) consumer does not want either to increase or to
decrease their holding of trees (if, at a hypothesized equilibrium price, every
identical consumer wanted (say) to increase their holdings, that price could not be an equilibrium price, because with a fixed supply of trees everyone cannot increase their holding of trees at once!).

Let $\Price_{t}$ denote the equilibrium price, and assume that if the tree is sold, the sale occurs after the existing owner receives that period's fruit ($\Price_{t}$ is the `ex-dividend' price).  Total resources available to consumer $i$ in period $t$ are the sum of the fruit received from the trees owned, $\dvdnd_{t}\kap_{t}^{i}$, plus the potential proceeds if the consumer were to sell all his stock of trees, $\Price_{t}\kap_{t}^{i}$.  Total resources are divided into two uses: Current consumption $c_{t}^{i}$ and the purchase of trees for next period $\kap_{t+1}^{i}$ at price $\Price_{t}$,
\begin{equation}\begin{gathered}\begin{aligned}
\overbrace{\kap_{t+1}^{i}\Price_{t}+c_{t}^{i}}^{\text{Uses of resources}}     & =  \overbrace{\dvdnd_{t}\kap_{t}^{i}+\Price_{t}\kap_{t}^{i}}^{\text{Total resources}} 
\\      \kap_{t+1}^{i} & =  (1+\dvdnd_{t}/\Price_{t})\kap_{t}^{i}-c_{t}^{i}/\Price_{t}.
\end{aligned}\end{gathered}\end{equation}

\pagebreak
\section{The Problem of an Individual Consumer}
Consumer $i$ maximizes 
\begin{equation}\begin{gathered}\begin{aligned}
%        \vFunc({m}_{t}^{i}) & =  \max ~ \Ex_{t}^{i}\left[\sum_{n=0}^{\infty} \DiscFac^{n} \log \cRat_{t+n}^{i} \right]  \label{eq:origprob}
        \vFunc({m}_{t}^{i}) & =  \max ~ \Ex_{t}^{i}\left[\sum_{n=0}^{\infty} \DiscFac^{n} \uFunc(\cRat_{t+n}^{i}) \right]  \label{eq:origprob}
\\      & \text{s.t.}    \nonumber
\\  \kap_{t+1}^{i} & =  (1+\dvdnd_{t}/\Price_{t})\kap_{t}^{i}-c_{t}^{i}/\Price_{t} \notag
\\  {m}_{t+1}^{i} & =  (\Price_{t+1}+\dvdnd_{t+1})\kap_{t+1}^{i}. \notag
\end{aligned}\end{gathered}\end{equation}
Rewriting in the form of Bellman's equation,\hypertarget{Bellman}{}
\begin{equation*}\begin{gathered}\begin{aligned}
        \vFunc({m}_{t}^{i}) & =  \max_{\{c_{t}^{i}\}} ~ \uFunc(c_{t}^{i}) + \DiscFac \Ex_{t}^{i}\left[\vFunc({m}_{t+1}^{i})\right]
%\\      & =  \max_{\{c_{t}^{i}\}} ~ \uFunc(c_{t}^{i}) + \DiscFac \Ex_{t}^{i}\left[\vFunc\left(({\Price}_{t+1}+\dvdnd_{t+1})\underbrace{\left((1+\dvdnd_{t}/\Price_{t})\kap_{t}^{i}-c_{t}^{i}/\Price_{t}\right)}_{\kap_{t+1}^{i}}\right)\right] \nonumber 
,
\end{aligned}\end{gathered}\end{equation*}
the first order condition tells us that \opt{MarginNotes}{\marginpar{\tiny Explain why the d/dC term corresponds to $\Risky$.}}
\begin{equation}\begin{gathered}\begin{aligned}
        0 & =  \uFunc^{\prime}(c_{t}^{i})+\DiscFac \Ex_{t}^{i}\left[\vFunc^{\prime}({m}_{t+1}^{i})\frac{d}{dc_{t}^{i}}\left(\overbrace{({\Price}_{t+1}+\dvdnd_{t+1})\underbrace{\left((1+\dvdnd_{t}/\Price_{t})\kap_{t}^{i}-c_{t}^{i}/\Price_{t}\right)}_{\kap_{t+1}^{i}}}^{{m}_{t+1}^{i}}\right)\right] 
\end{aligned}\end{gathered}\end{equation} 
so\hypertarget{FOCwithRisky}{}
\begin{equation}\begin{gathered}\begin{aligned}
 \uFunc^{\prime}(c_{t}^{i}) & =  \DiscFac \Ex_{t}^{i}\left[\vFunc^{\prime}({m}_{t+1}^{i})\left(\underbrace{\frac{{\Price}_{t+1}+\dvdnd_{t+1}}{\Price_{t}}}_{\equiv \Risky_{t+1}}\right)\right] \label{eq:FOCwithRisky}
\\  & =  \DiscFac \Ex_{t}^{i}\left[\Risky_{t+1} \vFunc^{\prime}({m}_{t+1}^{i})\right] 
\end{aligned}\end{gathered}\end{equation}
where $\Risky_{t+1}$ is the return factor that measures the resources in period $t+1$ that are the reward for 
owning a unit of trees at the end of $t$.

The \handoutC{Envelope} theorem tells us that  \hypertarget{pofci}{}
$\vFunc^{\prime}({m}_{t+1}^{i})=\uFunc^{\prime}(c_{t+1}^{i})$, so \eqref{eq:FOCwithRisky} becomes
\begin{verbatimwrite}{./eqns/LAP_pofci.tex}
\begin{equation}\begin{gathered}\begin{aligned}
\uFunc^{\prime}(c_{t}^{i}) & =  \DiscFac \Ex_{t}^{i}\left[\uFunc^{\prime}(\cRat_{t+1}^{i})\left(\frac{{\Price}_{t+1}+\dvdnd_{t+1}}{\Price_{t}}\right)\right]  
\\ \Price_{t} & =  \DiscFac \Ex_{t}^{i}
\left[
  \left(
    \frac{\uFunc^{\prime}(\cRat_{t+1}^{i})}{\uFunc^{\prime}(\cRat_{t}^{i})}
  \right)
  \left({\Price}_{t+1}+\dvdnd_{t+1}\right) \label{eq:pofci}
\right] .
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}

\input{./eqns/LAP_pofci.tex}

\section{Aggregation}

The assumption that all consumers are identical says that $c_{t}^{i} =
c_{t}^{j}~\forall~i,j$, so henceforth we just call consumption per capita $\cRat_{t}$.  Since aggregate consumption must equal aggregate production because fruit cannot be stored, normalizing the population to $\Pop_{t}=1 ~\forall ~ t$ and stock of trees to $\Kap_{t}=1 ~\forall~t$, equation \eqref{eq:CeqY} becomes:
\begin{equation}\begin{gathered}\begin{aligned}
%   \cRat_{t}\Pop_{t} & = \dvdnd_{t}\Kap_{t}\\ 
\cRat_{t} & =  \dvdnd_{t}.
\end{aligned}\end{gathered}\end{equation}

\hypertarget{pofd}{}
Substituting $\cRat_{t}$ and $\cRat_{t+1}$ for $c_{t}^{i}$ and $c_{t+1}^{i}$ in  (\ref{eq:pofci}) and then
substituting $\dvdnd_{t}$ for $\cRat_{t}$ we get
\begin{verbatimwrite}{./eqns/LAP_pofd.tex}
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t} & =  \DiscFac \Ex_{t}\left[\left(\frac{\uFunc^{\prime}(\dvdnd_{t+1})}{\uFunc^{\prime}(\dvdnd_{t})}\right)\left({\Price}_{t+1}+\dvdnd_{t+1}\right)\right] \label{eq:pofd}.
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_pofd.tex}


We can rewrite this more simply if we define an object
\begin{verbatimwrite}{./eqns/LAP_StochDiscFact.tex}
\begin{equation}\begin{gathered}\begin{aligned}
  \label{eq:StochDiscFact}
  \SDF_{t,t+n} & =  \DiscFac^{n} \left(\frac{\uFunc^{\prime}(\dvdnd_{t+n})}{\uFunc^{\prime}(\dvdnd_{t})}\right)
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_StochDiscFact.tex}
which is called the `stochastic discount factor' because (a) it is stochastic (thanks to the shocks between $t$ and $t+n$ that determine the value of $\dvdnd_{t+n}$); and (b) it measures the rate at which all agents in this economy in period $t$ will discount a unit of value received in a future period, e.g.\ $t+1$: \hypertarget{Pt}{}
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t} & =  \Ex_{t}\left[\SDF_{t,t+1}\left({\Price}_{t+1}+\dvdnd_{t+1}\right)\right] . \label{eq:Pt}
\end{aligned}\end{gathered}\end{equation}

A corresponding equation will hold in period $t+1$, and in period $t+2$, and beyond:
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t+1} & =  \Ex_{t+1}\left[\SDF_{t+1,t+2}\left({\Price}_{t+2}+\dvdnd_{t+2}\right)\right] \label{eq:Ptp1}
%\\ \Price_{t+2} & =  \Ex_{t+2}\left[\SDF_{t+2,t+3}\left({\Price}_{t+3}+\dvdnd_{t+3}\right)\right], %\label{eq:Ptp2}
\end{aligned}\end{gathered}\end{equation}
so we can use repeated substitution, e.g.\ of \eqref{eq:Ptp1} into \eqref{eq:Pt}, and so on to get
\begin{verbatimwrite}{./eqns/LAP_PtsubPtp1.tex}
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t} & =  \Ex_{t}\left[\SDF_{t,t+1}\dvdnd_{t+1}\right]+\Ex_{t}[\SDF_{t,t+1}\Ex_{t+1}[\SDF_{t+1,t+2}\dvdnd_{t+2}]]+ \ldots \label{eq:PtsubPtp1}
.
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_PtsubPtp1.tex}

The `law of iterated expectations' says that
$\Ex_{t}[\Ex_{t+1}[{\Price}_{t+2}]] = \Ex_{t}[{\Price}_{t+2}]$;
given this, and noting that $\SDF_{t,t+2} = \SDF_{t,t+1}\SDF_{t+1,t+2}$, \eqref{eq:PtsubPtp1} becomes:
\begin{verbatimwrite}{./eqns/LAP_PtAsPDV.tex}
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t} & =  \Ex_{t}\left[\SDF_{t,t+1}\dvdnd_{t+1}+\SDF_{t,t+2}\dvdnd_{t+2}+\SDF_{t,t+3}\dvdnd_{t+3}+...\right] . \label{eq:PtAsPDV}
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_PtAsPDV.tex}
So, the price of the asset is the present discounted value of the stream of future `dividends,'
where the stochastic factor by which (potentially stochastic) dividends received in $t+n$ are discounted back to $t$ is $\SDF_{t,t+n}$.


\section{Specializing the Model}
% Rework for CRRA throughout

This is as far as we can go without making explicit assumptions about the structure
of utility.  If utility is CRRA, $\uFunc(\cRat)=(1-\CRRA)^{-1}\cRat^{1-\CRRA},$ substituting $\uFunc^{\prime}(\dvdnd)=\dvdnd^{-\CRRA}$ into \eqref{eq:pofd} yields
\begin{verbatimwrite}{./eqns/LAP_pofdCRRA.tex}
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t} & =  \DiscFac \dvdnd_{t}^{\CRRA} \Ex_{t}\left[\dvdnd_{t+1}^{-\CRRA}(\Price_{t+1}+\dvdnd_{t+1})\right] \label{eq:pofdCRRA}
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_pofdCRRA.tex}
and the particularly special case of logarithmic utility (which Lucas emphasizes) corresponds to $\CRRA=1$, which (again using the law of iterated expectations) allows us to simplify \eqref{eq:pofdCRRA} to
\begin{verbatimwrite}{./eqns/LAP_pofdLog.tex}
\begin{equation*}\begin{gathered}\begin{aligned}
\frac{\Price_{t}}{\dvdnd_{t}} & =  \DiscFac \Ex_{t}\left[\dvdnd_{t+1}^{-1}(\Price_{t+1}+\dvdnd_{t+1})\right] \label{eq:pofdLog}
\\ & =  \DiscFac \left(1+\Ex_{t} \left[\frac{{\Price}_{t+1}}{\dvdnd_{t+1}}\right]\right)
\\ & =  \DiscFac \left(1+\DiscFac \left(1+\Ex_{t}\left[\frac{{\Price}_{t+2}}{\dvdnd_{t+2}}\right]\right)\right)
%\\ & =  \DiscFac \left(1+\DiscFac \left(1+\DiscFac \left(1+\Ex_{t}\left[\frac{{\Price}_{t+3}}{\dvdnd_{t+3}}\right]\right)\right)\right)
\\ & =  \DiscFac \left(1 + \DiscFac + \DiscFac^{2} + \ldots + \Ex_{t} \left[\lim_{n\rightarrow \infty}\DiscFac^{n-1}\left[\frac{\Price_{t+n}}{\dvdnd_{t+n}}\right]\right]\right)
%\\ & =  \DiscFac \left(1 + \DiscFac + \DiscFac^{2} + \DiscFac^{3} + \ldots + \Ex_{t} \left[\lim_{n\rightarrow \infty}\DiscFac^{n-1}\left[\frac{\Price_{t+n}}{\dvdnd_{t+n}}\right]\right]\right)
\\ & =  \frac{\DiscFac}{1-\DiscFac} + \DiscFac \Ex_{t}\left\{\lim_{n\rightarrow \infty}\DiscFac^{n-1}\left[\frac{\Price_{t+n}}{\dvdnd_{t+n}}\right]\right\}.
\end{aligned}\end{gathered}\end{equation*}
\end{verbatimwrite}
\input{./eqns/LAP_pofdLog.tex}

If the price is bounded (it cannot ever go, for 
example, to a value such that it would cost more than the economy's 
entire output to buy a single tree), it is possible to show that the limit term 
in this equation goes to zero.  Using the usual definition of the time preference factor
as $\DiscFac = 1/(1+\timeRate)$ where $\timeRate$ is the time preference rate, the equilibrium price is:
\begin{verbatimwrite}{./eqns/LAP_pWithLogU.tex}
\begin{equation}\begin{gathered}\begin{aligned}
 \Price_{t} & =  \dvdnd_{t}\left(\frac{\DiscFac}{1-\DiscFac} \right) \notag 
\\  & =  \dvdnd_{t}\left(\frac{1}{1/\DiscFac-1} \right) \notag 
\\  & =  \dvdnd_{t}\left(\frac{1}{1+\timeRate-1} \right) \notag
\\  & =  \frac{\dvdnd_{t}}{\timeRate} \label{eq:pWithLogU}
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_pWithLogU.tex}
or, equivalently, the `dividend-price ratio' is always $\dvdnd_{t}/\Price_{t} = \timeRate$.\footnote{A derivation parallel to the one above shows that in the CRRA utility case the solution is $\dvdnd_{t}^{\CRRA}/\Price_{t} = \timeRate.$}

It may surprise you that the equilibrium price of trees today does not depend on the expected level of fruit output in the future.  If the weather was bad this year, but is expected to return to normal next year (and, by definition, is expected to be equal to normal in subsequent years), you might think that the price today would mostly reflect the `normal' value of fruit prodution that the trees produce, not the (temporarily low) value that happens to obtain today.

The above derivation says that intuition is wrong: Today's price depends only on today's output.

Nevertheless, the logic above (higher future output is a reason for higher current prices) is not wrong; but it is (exactly) counterbalanced by another, and subtler, fact: Since future consumption will equal future fruit output, higher expected fruit output means lower marginal utility of consumption in that future period of (more) abundant fruit (basically, people are starving today, which reduces the attractiveness of reducing their consumption to buy trees that will produce more in a period when they expect \textit{not} to be starving).  These two forces are the manifestation of the (pure) income effect and substitution effect in this model (there is no human wealth, and therefore no human wealth effect).  In the special case of logarithmic utility considered here, income and substitution effects are of the same size and opposite sign so the two forces exactly offset.

\section{The Interest Rate and the `Rate of Return' in a Lucas Model}
We can decompose the return factor attributable to ownership of a share of capital (cf.\ \eqref{eq:FOCwithRisky}) by adding and subtracting $\Price_{t}$ in the numerator:
\begin{equation}\begin{gathered}\begin{aligned}
  \Risky_{t+1} & =  \left(\frac{{\Price}_{t+1}+{\Price}_{t}-{\Price}_{t}+\dvdnd_{t+1}}{\Price_{t}}\right) \notag
\\        & =  \left(1+\frac{\Delta {\Price}_{t+1}}{\Price_{t}}+\frac{\dvdnd_{t+1}}{\Price_{t}}\right) \label{eq:RiskyDecompose}
\end{aligned}\end{gathered}\end{equation}
so the `rate of return' is 
\begin{equation}\begin{gathered}\begin{aligned}
 \risky_{t+1}    & =  \frac{\Delta {\Price}_{t+1}}{\Price_{t}}+\frac{\dvdnd_{t+1}}{\Price_{t}} \label{eq:riskyDecompose}
\end{aligned}\end{gathered}\end{equation}
which is a useful decomposition because the two components 
have natural interpretations: The first is a `capital gain' (or loss),
and the second can plausibly identified as `the interest rate' paid
by the asset (because it corresponds to income received regardless of whether the asset
is liquidated).

In models that do not explicitly discuss asset pricing, the
implicit assumption is usually that the price of capital is constant
(which might be plausible if capital consists mostly of reproducible items
like machines,\footnote{The key insights below remain true even if there is a gradual trend in the real price of capital goods, as has in fact been true.} rather than Lucas trees).  In this case
\begin{equation*}\begin{gathered}\begin{aligned}
  \Risky_{t+1} & =  \left(1+\frac{\dvdnd_{t+1}}{\Price_{t}}\right)
\end{aligned}\end{gathered}\end{equation*}
says that the only risk in the rate of return is attributable to unpredictable variation in the size of 
dividend/interest payments.  Indeed, if additional assumptions are made (e.g., perfect capital markets) that yield the conclusion that the interest rate matches the marginal product of capital, then such models generally imply that variation in returns (at least at high frequencies) is very small, because aggregate capital typically is very stable from one period to the next in such models, and, if the aggregate production function is stable, this implies great stability in the marginal product of capital.

\begin{comment}% Final16 idea:  

Empirically, this is a bad assumption:  Using, e.g., quarterly data from the S\&P 500 stock index in the U.S.\, the
variation in total returns that reflects changes in dividends is only about [5?] percent.  Note further that 
the logarithmic utility model has an explicit prediction:  since $\Price_{t}/\dvdnd_{t} = \timeRate$, that model
says that the size of {\emph fluctuations} in prices is identical to the size of fluctuations in dividends: $\Delta \Price_{t+1}/\Price_{t} = \Delta \dvdnd_{t+1}/\dvdnd_{t}$.  Oops!

\end{comment}


\section{Aggregate Returns Versus Individual Returns}

One of the subtler entries in \cite{aristotleFallacies}'s catalog of common human reasoning errors was the `fallacy of composition,' in which the reasoner supposes that if a proposition is true of each element of a whole, then it must be true of the whole.

The Lucas model provides a counterexample.  From the standpoint of any individual (atomistic) agent, it is quite true that a decision to save one more unit will yield greater future resources, in the amount $\Risky_{t+1}$.  But from the standpoint of the society as a whole, if everyone decided to do the same thing (save one more unit), there would be no effect on aggregate resources in period $t+1$.  Put another way, for any individual agent, it appears that the `marginal product of capital' is $\risky_{t+1}$, but for the society as a whole the marginal product of capital is zero.

The proposition that the return for society as a whole must be the same as the return that is available to individuals is an error because it implicitly assumes that there are no general equilibrium effects of a generalized desire to save more (or, more broadly, that there is no interaction between the decisions one person makes and the outcomes for another person).  The Lucas model provides a counterexample in which, if everyone's preferences change (e.g., $\timeRate$ goes down for everyone), the price of the future asset is affected -- indeed, it is affected in a way that is sufficient to exactly counteract the increased desire for ownership of future dividends (since there is a fixed supply of assets to be owned, the demand must be reconciled with that preexisting supply).

Aristotle was a smart guy!

\section{Analytical and Numerical Solutions}

The appendices derive various results about the solution to the model under
different assumptions.  But, unfortunately, the model has analytical solutions
(like, $P = d/\vartheta$) or approximate analytical solutions only in very special circumstances.  The accompanying
\href{https://mybinder.org/v2/gh/econ-ark/DemARK/HEAD?filepath=notebooks/Lucas-Asset-Pricing-Model.ipynb}{DemARK notebook}
shows how to solve the model numerically for a simple case where there is no
such analytical solution (the case where dividends follow an AR(1) process), and also shows
how the numerical solution compares with the approximate analytical solution in the CRRA utility case.

\pagebreak
\appendix \renewcommand{\thesection}{\arabic{section}} % For some reason after \appendix it stops putting 0. before subsection numbers; this fixes it

\centerline{\Large Appendix:  Analytical Solutions in CRRA Utility Case}

\medskip\medskip\medskip

\section{When Dividends are IID}


Suppose $\dvdnd_{t+n}$ is identically individually distributed in every future period, so that its expectation as of $t$ is the same for any date $n>0$:
\begin{equation}\begin{gathered}\begin{aligned}
  \edvdnd & \equiv  \Ex_{t}[\dvdnd_{t+n}^{1-\CRRA}].   \label{eq:dmod}
\end{aligned}\end{gathered}\end{equation}

Now note that \eqref{eq:pofdCRRA} can be rewritten as
\begin{equation}\begin{gathered}\begin{aligned}
  \frac{\Price_{t}}{\dvdnd_{t}^{\CRRA}}          & =  \DiscFac \left( \edvdnd + \Ex_{t}\left[\frac{\Price_{t+1}}{\dvdnd_{t+1}^{\CRRA}}\right] \right) \notag
\\ & =  \DiscFac \edvdnd \left(1 + \DiscFac + \DiscFac \Ex_{t}\left[\frac{\Price_{t+2}}{\dvdnd_{t+2}^{\CRRA}}\right]\right) \notag
\\ & =  \DiscFac \edvdnd \left(1 + \DiscFac  + \DiscFac^{2} + \ldots + \underbrace{\Ex_{t} \left[\lim_{n\rightarrow \infty}\DiscFac^{n-1}\left[\frac{\Price_{t+n}}{\dvdnd_{t+n}^{\CRRA}}\right]\right]}_{\text{assume goes to zero}}\right) 
\\ & =  \left(\frac{\DiscFac \edvdnd}{1-\DiscFac}\right)
\\ & =  \left(\frac{\edvdnd}{\DiscFac^{-1}-1}\right) \label{eq:PtCRRA}
\end{aligned}\end{gathered}\end{equation}

To make further progress, suppose that the iid process for dividends is a mean-one lognormal: $\log \dvdnd_{t+n} \sim \mathcal{N}(-\sigma^{2}/2,\sigma^{2})~\forall~n$ so that $\Ex_{t}[\dvdnd_{t+n}]=1~\forall~n$ (see \ELogNormMeanOne), in which case \ELogNormTimes~can be used to show that
\begin{equation}\begin{gathered}\begin{aligned}
%  \log \edvdnd & =  -(1/2)(1-\CRRA)\sigma^{2}%\underbrace{-(1-\CRRA)\sigma^{2}/2}_{-(1/2)\sigma^{2}+\CRRA \sigma^{2}/2}
% + \underbrace{(1/2)(1-\CRRA)(1-\CRRA) \sigma^{2}}_{(1/2)(1-\CRRA) \sigma^{2}-\CRRA (1/2)\sigma^{2}}
%\\ & =  \CRRA (\CRRA-1) (1/2)\sigma^{2}\\
 \edvdnd & =  e^{\CRRA(\CRRA-1)(1/2)\sigma^{2}} \label{eq:edvdndSimple}
\end{aligned}\end{gathered}\end{equation}
and if we approximate $\DiscFac \approx e^{-\timeRate}$ then $\DiscFac^{-1} \approx 1+\timeRate$ and so \eqref{eq:PtCRRA} becomes
\begin{equation*}\begin{gathered}\begin{aligned}
  \frac{\Price_{t}}{\dvdnd_{t}^{\CRRA}} % & \approx  \left(\frac{e^{\CRRA(\CRRA-1)\sigma^{2}/2 - \timeRate}}{1-e^{\CRRA(\CRRA-1)\sigma^{2}/2 - \timeRate}}\right) \\
 & \approx  \left(\frac{e^{\CRRA(\CRRA-1)(1/2)\sigma^{2}}}{\timeRate}\right)
\\ \Price_{t} & \approx  \left(\frac{\dvdnd_{t}^{\CRRA} e^{\CRRA(\CRRA-1)(1/2)\sigma^{2}}}{\timeRate}\right)
\end{aligned}\end{gathered}\end{equation*}
So the log is
\begin{verbatimwrite}{./eqns/LAP_PtLogIID.tex}
\begin{equation}\begin{gathered}\begin{aligned}
  \log \Price_{t} & \approx  \CRRA \log \dvdnd_{t} + \CRRA(\CRRA-1)(1/2)\sigma^{2} - \log \timeRate \label{eq:PtLogIID}
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_PtLogIID.tex}
and thus the variances obey
\begin{equation}\begin{gathered}\begin{aligned}
  \label{eq:varLogPvsLogd}
  \var({\log \Price}) & =  \CRRA^{2} \var(\log \dvdnd)
.
\end{aligned}\end{gathered}\end{equation}


Given that $\CRRA > 1$, this derivation yields some interesting insights:
\begin{enumerate}
  \item (the log of) asset prices will be more volatile than (the log of) dividends
  \item An increase in risk aversion $\CRRA$ increases the price $\Price_{t}$ (because $\CRRA(\CRRA-1)\sigma^{2}/2 > 0$ and an increase in $\CRRA$ increases its size)  %if $\dvdnd_{t} > -\CRRA (\CRRA-1)\sigma^{2}/2$.   
\end{enumerate}

The second point is surprising, so let me say it again: an \textit{increase} in risk aversion \textit{increases} the price of the risky asset.  In a sense, this is an implication of the proposition that risk aversion increases the volatility of asset prices (when they are high, they must be \textit{very} high; when low, \textit{very} low).  But, it does not correspond very well to the common narrative in which market analysts often attribute a decline in asset prices to `increased risk aversion.'  

\section{When Dividends Follow a Random Walk}

The polar alternative to IID shocks would be for dividends to follow a random walk: $\log (\dvdnd_{t+1}/\dvdnd_{t}) \sim \mathcal{N}(-\sigma^{2}/2,\sigma^{2})$.

Now divide both sides of \eqref{eq:pofdCRRA} by $\dvdnd_{t}$, and rewrite the object inside the expectations operator by multiplying the first term by $\dvdnd_{t+1}$ and dividing the second term by $\dvdnd_{t+1}$, yielding
\begin{verbatimwrite}{./eqns/LAP_pofdCRRAWdvdndGro.tex}
\begin{equation}\begin{gathered}\begin{aligned}
 \left(\frac{\Price_{t}}{\dvdnd_{t}}\right) & =  \DiscFac \dvdnd_{t}^{-(1-\CRRA)} \Ex_{t}\left[\dvdnd_{t+1}^{1-\CRRA}\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] 
\\ & =   \DiscFac  \Ex_{t}\left[\left(\frac{\dvdnd_{t+1}}{\dvdnd_{t}}\right)^{1-\CRRA}\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] \label{eq:pofdCRRAWdvdndGro}
.
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_pofdCRRAWdvdndGro.tex}

Now (1) note that our assumption here about the distribution of $\dvdnd_{t+1}/\dvdnd_{t}$ is identical to the assumption about $\dvdnd_{t+1}$ above, so the expectation will be the same $\edvdnd$; and (2) hypothesize that there will be a solution under which the price-dividend ratio is a constant; call it $\risky^{-1}$:  
\begin{verbatimwrite}{./eqns/LAP_pofdCRRAIsConst.tex}
\begin{equation}\begin{gathered}\begin{aligned}
\risky^{-1}  & =   \DiscFac  \left[\edvdnd(\risky^{-1}+1)\right] 
\\ 1 & =  \DiscFac \edvdnd (1+\risky)
\\ \left(\frac{1-\DiscFac \edvdnd}{\DiscFac \edvdnd}\right)  & =  \risky
\\ \left(\frac{1}{(\DiscFac \edvdnd)^{-1}-1}\right)  & =  \risky^{-1}
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_pofdCRRAIsConst.tex}
so that we obtain a formula for $\risky^{-1} = \Price_{t}/\dvdnd_{t}$
\begin{verbatimwrite}{./eqns/LAP_PtLogRW.tex}
\begin{equation}\begin{gathered}\begin{aligned}
  \log \Price_{t} & \approx  \log \dvdnd_{t}  - \log (\timeRate -  (1/2)\CRRA (\CRRA-1) \sigma^{2})\label{eq:PtLogRW}
\end{aligned}\end{gathered}\end{equation}
\end{verbatimwrite}
\input{./eqns/LAP_PtLogRW.tex}

The difference with \eqref{eq:PtLogIID} is only the absence of the $\CRRA$ multiplying $\log \dvdnd_{t}$.  The main substantive difference is therefore that the variance of (log) prices and the variance of (log) dividends is now the same.  The surprising result that the price-dividend ratio increases when risk aversion increases continues to hold.

\begin{comment}
  % 20201104: The stuff below is wrong because the assumption was that dividends follow an AR(1) in LEVELS which is crazy
\section{When Dividends Follow an AR(1) Process}

Start with \eqref{eq:pofdCRRAWdvdndGro}:
\input {./eqns/LAP_pofdCRRAWdvdndGro.tex}
and substitute for $\dvdnd_{t+1}=\alpha \dvdnd_{t} + \err_{t+1}$:
\begin{equation}\begin{gathered}\begin{aligned}
 \left(\frac{\Price_{t}}{\dvdnd_{t}}\right) & =   \DiscFac  \Ex_{t}\left[\left(\frac{\alpha \dvdnd_{t}+\err_{t+1}}{\dvdnd_{t}}\right)^{1-\CRRA}\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] 
\end{aligned}\end{gathered}\end{equation}

We cannot make further analytical progress so long as the $\err_{t+1}$ term is present.  

Numerical solutions tend to work best when it is possible to define
the limits as the state variables approach their maximum possible
values, so the next step is to try to compute such limits.

\subsubsection{As $\dvdnd~\uparrow~\infty$}

In the limit as $\dvdnd_{t}$ approaches $\infty$, the $\err_{t+1}$ term becomes arbitrarily small (relative to $\dvdnd_{t}$).  Thus,
\begin{equation}\begin{gathered}\begin{aligned}
 \lim_{\dvdnd_{t} \uparrow \infty} \left(\frac{\Price_{t}}{\dvdnd_{t}}\right) & =   \DiscFac  \left[\alpha^{1-\CRRA}\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] 
\\ & =  \left(\frac{\DiscFac \alpha^{1-\CRRA}}{1-(\DiscFac \alpha^{1-\CRRA})}\right)
\\ & =  \left(\frac{1}{\DiscFac^{-1} \alpha^{\CRRA-1} - 1}\right)
\end{aligned}\end{gathered}\end{equation}

\subsubsection{As $\dvdnd~\downarrow~0$}

Suppose that $\log \err_{t+1} \sim \mathcal{N}(-\sigma^{2}/2,\sigma^{2})$.  Then $\ELogNormTimes$ says:
\begin{equation}\begin{gathered}\begin{aligned}
  \log \Ex_{t}[\err_{t+1}\dvdnd_{t}^{-1}] & =  -(1-\CRRA)\dvdnd_{t}^{-1} \sigma^{2}/2 + \left(\frac{(1-\CRRA)}{\dvdnd_{t}^{-1}}\right)^{2}\sigma^{2}/2
\\ & =  \dvdnd_{t}^{-1}\left(-(1-\CRRA) \sigma^{2}/2 + \left(\frac{(1-\CRRA)^{2}}{\dvdnd_{t}}\right)\sigma^{2}/2\right)
\end{aligned}\end{gathered}\end{equation}
whose limit is 
\begin{equation}\begin{gathered}\begin{aligned}
 \lim_{\dvdnd_{t} \downarrow 0} \log \Ex_{t}[\err_{t+1}\dvdnd_{t}^{-1}] & =   \left(\left(\frac{(1-\CRRA)}{\dvdnd_{t}}\right)^{2}\sigma^{2}/2\right)
\end{aligned}\end{gathered}\end{equation}
so 
\begin{equation}\begin{gathered}\begin{aligned}
 \lim_{\dvdnd_{t} \downarrow 0} \left(\frac{\Price_{t}}{\dvdnd_{t}}\right) & =   \DiscFac  \left[\left(\left(\frac{(1-\CRRA)}{\dvdnd_{t}}\right)^{2}\sigma^{2}/2\right)\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] 
%\\ \lim_{\dvdnd_{t} \downarrow 0} \left(\Price_{t}\right) & =   \dvdnd_{t}^{-1} \DiscFac  \left[\left((1-\CRRA)^{2}\sigma^{2}/2\right)\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] 
\end{aligned}\end{gathered}\end{equation}
so since $\Price_{t+1}/\dvdnd_{t+1}$ is a finite number we should have that 
\begin{equation}\begin{gathered}\begin{aligned}
  \dvdnd_{t}^{2}  \lim_{\dvdnd_{t} \downarrow 0} \left(\frac{\Price_{t}}{\dvdnd_{t}}\right) & =  \DiscFac  \left[\left(\left(\frac{(1-\CRRA)}{1}\right)^{2}\sigma^{2}/2\right)\left(\frac{\Price_{t+1}}{\dvdnd_{t+1}}+1\right)\right] 
\end{aligned}\end{gathered}\end{equation}
which should imply that $\Price_{t} \dvdnd_{t}$ is a finite number even as $\dvdnd_{t} \downarrow 0$.  To have both limits be finite, we might be able to use a trick like the ones proposed by \cite{boyd:weighted}.  This would involve multiplying by some $f(\dvdnd)$ that approaches $\dvdnd_{t}^{2}$ as $\dvdnd_{t}$ approaches zero but approaches 1 as $\dvdnd_{t}$ approaches infinity.  Like, $f(d) = \dvdnd^{2} \left(\frac{1}{1+\dvdnd^{2}}\right)$? (The idea is that $f(\dvdnd) \Price_{t}/\dvdnd_{t}$ might be finite in both limits (and everywhere in between) even if $\Price_{t}/\dvdnd_{t}$ is not).  [Think more about this later].

{\bf Alternative}.  The solution to the AR(1) case is surely somewhere between the solutions to the IID and RW cases.  That means that 
it is between 
\input{./eqns/LAP_PtLogIID.tex}
and 
\input{./eqns/LAP_PtLogRW.tex}
which can surely somehow be used to produce a reasonable limit.  Actually, it seems pretty clear that the relevant comparison is to the IID case.

\end{comment}

\input handoutBibMake

\end{document}
